console.log("🚀 Etageplan Listener script loaded"),document.addEventListener("DOMContentLoaded",function(){function e(e){console.log("🔍 Looking for apartment:",e);const t=document.querySelector(`[data-apartment-id="${e}"]`);if(t){const n=t.querySelector(".apartment_modal-wrapper");n?(console.log("✅ Opening modal for apartment:",e),document.querySelectorAll(".apartment_modal-wrapper.is-open").forEach(e=>{e.classList.remove("is-open")}),console.log("🔒 Closed all modals (scroll unchanged)"),window.lenis?(window.lenis.stop(),setTimeout(()=>{const e=document.querySelector(".apartment_modal-wrapper.is-open");if(e){const t=e.querySelector(".apartment_modal, .apartment_modal-content, .modal-content, [data-modal-content]");t?(window.lenis.start(),setTimeout(()=>{window.lenis.stop(),t.addEventListener("wheel",o,{passive:!1}),t.style.setProperty("overflow-y","auto","important"),t.style.setProperty("max-height","100vh","important"),window.lenis.start(),setTimeout(()=>{window.lenis.stop(),t.addEventListener("wheel",o,{passive:!1})},10),console.log("🎯 Modal scroll enabled for:",t.className)},10)):console.warn("⚠️ No modal content found for scroll handling")}},50),console.log("🚫 Lenis scroll disabled")):(document.body.style.overflow="hidden",document.body.style.paddingRight=function(){const e=document.createElement("div");e.style.visibility="hidden",e.style.overflow="scroll",e.style.msOverflowStyle="scrollbar",document.body.appendChild(e);const o=document.createElement("div");e.appendChild(o);const t=e.offsetWidth-o.offsetWidth;return e.parentNode.removeChild(e),t}()+"px",console.log("🚫 Normal scroll disabled")),n.classList.add("is-open")):console.error("❌ Modal wrapper not found for apartment:",e)}else console.error("❌ Apartment container not found with ID:",e)}function o(e){const o=e.currentTarget;if(o.scrollHeight<=o.clientHeight)return void e.preventDefault();const t=o.scrollTop,n=o.scrollHeight,l=o.clientHeight;(t<=0&&e.deltaY<0||t>=n-l&&e.deltaY>0)&&e.preventDefault(),console.log("🎯 Modal scroll:",{scrollTop:t,scrollHeight:n,clientHeight:l,deltaY:e.deltaY})}function t(){document.querySelectorAll(".apartment_modal, .apartment_modal-content, .modal-content, [data-modal-content]").forEach(e=>{e.removeEventListener("wheel",o),e.style.removeProperty("overflow-y"),e.style.removeProperty("max-height")}),window.lenis?(window.lenis.start(),console.log("✅ Lenis scroll enabled")):(document.body.style.overflow="",document.body.style.paddingRight="",console.log("✅ Normal scroll enabled"))}function n(e){e.classList.remove("is-open"),t(),console.log("🔒 Modal closed")}console.log("📄 DOM ready, initializing etageplan listener"),window.addEventListener("message",function(o){if(console.log("📨 Received postMessage:",o.data),o.data&&"openApartment"===o.data.type){const t=o.data.apartmentId;console.log("📨 Received apartment ID from SVG:",t),e(t)}}),document.addEventListener("keydown",function(e){"Escape"===e.key&&(document.querySelectorAll(".apartment_modal-wrapper.is-open").forEach(e=>{e.classList.remove("is-open")}),t(),console.log("🔒 Closed all modals"))}),function(){const e=document.querySelectorAll("[data-apartment-modal-toggle]");e.forEach(e=>{e.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation();const o=this.closest(".apartment_modal-wrapper");o&&n(o)})}),console.log(`🎯 Setup ${e.length} modal close handlers`)}(),function(){const e=document.querySelectorAll(".apartment_overlay");e.forEach(e=>{e.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation();const o=this.closest(".apartment_modal-wrapper");o&&n(o)})}),console.log(`🎯 Setup ${e.length} overlay close handlers`)}(),console.log("✅ LiveCPH Etageplan Listener initialized with modal support")});